@tailwind base;
@tailwind components;
@tailwind utilities;

@layer utilities {
  .text-balance {
    text-wrap: balance;
  }
}

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 220 13% 18%;
    --card: 0 0% 100%;
    --card-foreground: 220 13% 18%;
    --popover: 0 0% 100%;
    --popover-foreground: 220 13% 18%;
    --primary: 244 57% 50%;
    --primary-foreground: 0 0% 100%;
    --secondary: 220 14% 96%;
    --secondary-foreground: 220 13% 18%;
    --muted: 220 14% 96%;
    --muted-foreground: 220 9% 46%;
    --accent: 244 57% 50%;
    --accent-foreground: 0 0% 100%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 0 0% 98%;
    --border: 220 13% 91%;
    --input: 220 13% 91%;
    --ring: 244 57% 50%;
    --radius: 0.625rem;
  }
  .dark {
    --background: 220 13% 8%;
    --foreground: 220 14% 96%;
    --card: 220 13% 11%;
    --card-foreground: 220 14% 96%;
    --popover: 220 13% 11%;
    --popover-foreground: 220 14% 96%;
    --primary: 244 57% 58%;
    --primary-foreground: 0 0% 100%;
    --secondary: 220 13% 15%;
    --secondary-foreground: 220 14% 96%;
    --muted: 220 13% 15%;
    --muted-foreground: 220 9% 60%;
    --accent: 244 57% 58%;
    --accent-foreground: 0 0% 100%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 220 13% 18%;
    --input: 220 13% 18%;
    --ring: 244 57% 58%;
    --radius: 0.625rem;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
  }
}

/* Algolia Chat Widget Overrides – full-page layout, no floating/toggle */
.ais-Chat {
  --ais-chat-primary: hsl(var(--primary));
  --ais-chat-background: hsl(var(--card));
  --ais-chat-foreground: hsl(var(--card-foreground));
  position: static !important;
  width: 100% !important;
  height: 100% !important;
  min-height: 0 !important;
  max-width: 100% !important;
  max-height: 100% !important;
  box-shadow: none !important;
  border-radius: 0 !important;
  display: flex !important;
  flex-direction: column !important;
}

/* Always show and fill the chat container (ignore closed state) */
.ais-Chat-container {
  display: flex !important;
  flex-direction: column !important; /* header top, then messages, then prompt bottom */
  flex: 1 1 0 !important;
  min-height: 0 !important;
  height: 100% !important;
  width: 100% !important;
  max-width: 100% !important;
  position: static !important;
  inset: auto !important;
  transform: none !important;
  border-radius: var(--radius) !important;
  border: 1px solid hsl(var(--border)) !important;
  overflow: hidden;
}

/* Maximized state: chat fills viewport (resize button toggles this) */
.ais-Chat.ais-Chat--maximized,
.ais-Chat-container.ais-Chat-container--maximized {
  position: fixed !important;
  inset: 0 !important;
  z-index: 50 !important;
  width: 100vw !important;
  height: 100vh !important;
  max-width: 100vw !important;
  max-height: 100vh !important;
  border-radius: 0 !important;
}

/* Force layout order: header (top) → messages (middle) → prompt (bottom) */
.ais-Chat-container > .ais-ChatHeader {
  order: 0;
  flex-shrink: 0;
  position: relative;
  z-index: 10;
}
.ais-Chat-container > .ais-ChatMessages {
  order: 1;
  flex: 1 1 0;
  min-height: 0;
  overflow: hidden;
  position: relative;
  z-index: 0;
}
.ais-Chat-container > .ais-ChatPrompt {
  order: 2;
  flex-shrink: 0;
}

/* Messages list: normal column so oldest at top, newest at bottom */
.ais-ChatMessages,
.ais-ChatMessages-scroll,
.ais-ChatMessages-content {
  display: flex !important;
  flex-direction: column !important;
}
.ais-ChatMessages-content {
  justify-content: flex-start !important;
  gap: 1.25rem !important;
}
.ais-ChatMessages-content > .ais-ChatMessage,
.ais-ChatMessages-content > .ais-ChatMessageLoader {
  margin-bottom: 0.25rem !important;
}
.ais-ChatMessages-content > .ais-ChatMessage:last-child,
.ais-ChatMessages-content > .ais-ChatMessageLoader:last-child {
  margin-bottom: 0 !important;
}

/* Purple header: compact height, ensure buttons aren’t clipped and stay clickable */
.ais-ChatHeader {
  background: hsl(var(--primary)) !important;
  color: hsl(var(--primary-foreground)) !important;
  flex-shrink: 0 !important;
  min-height: 2.5rem !important;
  padding: 0 0.625rem !important;
  line-height: 2.5rem !important;
  overflow: visible !important;
  display: flex !important;
  align-items: center !important;
  justify-content: space-between !important;
  gap: 0.5rem !important;
  pointer-events: auto !important;
  isolation: isolate !important;
}
.ais-ChatHeader .ais-ChatHeader-actions {
  display: flex !important;
  align-items: center !important;
  gap: 0.25rem !important;
  flex-shrink: 0 !important;
  pointer-events: auto !important;
}
.ais-ChatHeader .ais-ChatHeader-clear,
.ais-ChatHeader .ais-ChatHeader-maximize,
.ais-ChatHeader .ais-ChatHeader-close {
  pointer-events: auto !important;
  cursor: pointer !important;
  min-width: 1.75rem !important;
  min-height: 1.75rem !important;
  padding: 0.25rem 0.5rem !important;
  flex-shrink: 0 !important;
  position: relative !important;
  z-index: 1 !important;
}
/* Clear has text label – needs space and must stay clickable */
.ais-ChatHeader .ais-ChatHeader-clear {
  min-width: 2.5rem !important;
  font-size: 0.75rem !important;
}
.ais-ChatHeader .ais-ChatHeader-clear:not(:disabled):hover {
  opacity: 1 !important;
  background: hsl(var(--primary-foreground) / 0.15) !important;
  border-radius: 0.25rem !important;
}
/* Star/logo and icons in header – proportional to header height */
.ais-ChatHeader .ais-ChatHeader-titleIcon,
.ais-ChatHeader .ais-ChatHeader-titleIcon svg,
.ais-ChatHeader [class*="titleIcon"] svg,
.ais-ChatHeader [class*="Icon"] svg,
.ais-ChatHeader .ais-ChatHeader-title span svg,
.ais-ChatHeader svg {
  width: 0.75rem !important;
  height: 0.75rem !important;
  min-width: 0.75rem !important;
  min-height: 0.75rem !important;
  max-width: 0.75rem !important;
  max-height: 0.75rem !important;
}
.ais-ChatHeader .ais-ChatHeader-titleIcon,
.ais-ChatHeader [class*="titleIcon"] {
  width: 0.75rem !important;
  height: 0.75rem !important;
  min-width: 0.75rem !important;
  min-height: 0.75rem !important;
  display: inline-flex !important;
  align-items: center !important;
  justify-content: center !important;
}

/* Hide tool/JSON output so only the conversational text response shows */
.ais-ChatMessage-tool {
  display: none !important;
}

/* Smaller loading indicator while response is streaming */
.ais-ChatMessageLoader .ais-ChatMessage-container {
  padding: 0.25rem 0.5rem !important;
}
.ais-ChatMessageLoader-spinner,
.ais-ChatMessageLoader-spinner svg {
  width: 1rem !important;
  height: 1rem !important;
  min-width: 1rem !important;
  min-height: 1rem !important;
}
.ais-ChatMessageLoader-text {
  font-size: 0.75rem !important;
}
.ais-ChatMessageLoader-skeletonWrapper {
  margin-top: 0.25rem !important;
}
.ais-ChatMessageLoader-skeletonItem {
  height: 0.5rem !important;
  max-width: 12rem !important;
}

/* Hide the floating toggle completely (removes the large "V+" in the center) */
.ais-Chat-toggleButtonWrapper,
.ais-Chat-toggleButton {
  display: none !important;
}

/* Ensure only the chat container is visible; hide any other siblings (e.g. toggle) */
.ais-Chat > *:not(.ais-Chat-container) {
  display: none !important;
}

/* Differentiate question (right) vs answer (left) – widget uses --left / --right */
.ais-ChatMessage--right {
  align-self: flex-end !important;
}
.ais-ChatMessage--right .ais-ChatMessage-container {
  background: hsl(var(--primary)) !important;
  color: hsl(var(--primary-foreground)) !important;
  margin-left: auto !important;
  border-radius: 1rem 1rem 0.25rem 1rem !important;
  border: 1px solid hsl(var(--primary) / 0.3) !important;
  box-shadow: 0 1px 2px hsl(var(--primary) / 0.2) !important;
}
.ais-ChatMessage--right .ais-ChatMessage-message {
  font-weight: 500 !important;
  color: hsl(var(--primary-foreground)) !important;
}

.ais-ChatMessage--left {
  align-self: flex-start !important;
}
.ais-ChatMessage--left .ais-ChatMessage-container {
  background: hsl(var(--muted)) !important;
  color: hsl(var(--foreground)) !important;
  border-radius: 1rem 1rem 1rem 0.25rem !important;
  border: 1px solid hsl(var(--border)) !important;
  box-shadow: 0 1px 2px hsl(220 13% 18% / 0.06) !important;
}
.ais-ChatMessage--left .ais-ChatMessage-content,
.ais-ChatMessage--left .ais-ChatMessage-message {
  color: hsl(var(--foreground)) !important;
}
.ais-ChatMessage--left .ais-ChatMessage-message {
  font-weight: 400 !important;
}
